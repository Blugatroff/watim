extern "wasi_unstable" "fd_write" fn raw_write(file: i32, ptr: i32, len: i32, nwritten: i32) -> i32

fn write(file: i32, ptr: i32, len: i32) -> i32 {
    memory space 8 4;
    local written: i32
    $space $ptr store32
    $space 4 + $len store32
    $file $space 1 $space raw_write drop
    $space load32 #written
    $written $len = if {
        $len
    } else {
        $file $ptr $written + $len $written - write $written +
    }
}

swap 

fn main "_start" () {
    1 2 3 4 raw_write drop
}
